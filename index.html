<!DOCTYPE html>
<html lang="de">
<head>
  <!-- MathJax für LaTeX-Formeln -->
<script>
  window.MathJax = {
    tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
    svg: { fontCache: 'global' }
  };
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <meta charset="UTF-8">
  <title>Streckenrechner</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
    }

    h1 {
      text-align: center;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px 10px;
      align-items: center;
    }

    label {
      font-weight: bold;
    }

    input[type="number"],
    input[type="text"] {
      width: 100%;
      padding: 5px;
      font-size: 1rem;
    }

    .unit {
      margin-left: 5px;
    }

    .radio-group {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .result-field {
      grid-column: 1 / -1;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .gender-group {
      grid-column: 1 / -1;
    }

    .bar-container {
      grid-column: 1 / -1;
      margin-top: 20px;
    }

    .bar {
      height: 24px;
      margin-top: 5px;
      background-color: steelblue;
      color: white;
      text-align: right;
      padding-right: 5px;
      border-radius: 5px;
      line-height: 24px;
    }

    .bar.min {
      background-color: seagreen;
    }

    .bar.max {
      background-color: crimson;
    }

    .info-button {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 24px;
      cursor: pointer;
      background: none;
      border: none;
    }

    .modal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.6);
      display: none;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: white;
      padding: 20px;
      max-width: 600px;
      border-radius: 10px;
    }

    .modal-content h2 {
      margin-top: 0;
    }

    .close {
      float: right;
      font-size: 1.2rem;
      cursor: pointer;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/12.4.1/math.min.js"></script>
</head>
<body>
  <button class="info-button" onclick="document.getElementById('infoModal').style.display = 'flex'">ℹ️</button>

  <h1>Berechnung der tatsächlichen Strecke</h1>

  <div class="form-grid">
    <label for="strecke">Gelaufene Strecke:</label>
    <div>
      <input type="number" id="strecke" value="1000" min="0"> <span class="unit">m</span>
    </div>

    <div class="gender-group">
      <label>Geschlecht:</label>
      <div class="radio-group">
        <label><input type="radio" name="gender" value="m" checked> männlich</label>
        <label><input type="radio" name="gender" value="w"> weiblich</label>
      </div>
    </div>

    <div class="result-field">
      <label for="result">Tatsächliche Strecke:</label>
      <input type="text" id="result" readonly> <span class="unit">m</span>
    </div>

    <div class="bar-container">
      <div id="barMin" class="bar min" style="width: 0">Min</div>
      <div id="barMax" class="bar max" style="width: 0">Max</div>
    </div>
  </div>

  <div class="modal" id="infoModal">
  <div class="modal-content">
    <span class="close" onclick="document.getElementById('infoModal').style.display='none'">&times;</span>
    <h2>Hintergrund & Annahmen</h2>

    <h3>Gegebene Gleichungen:</h3>

    <p>\[
    t_{\text{wind}} + t_{\text{windlos}} = 720\,\text{s}
    \]</p>

    <p>Bewegungsgesetz</p>
    <p>\[
    t_{\text{wind}} \cdot v_{\text{wind}} = r \cdot s_{\text{gesamt}}
    \]</p>

    <p>Bewegungsgesetz</p>
    <p>\[
t_{\text{windlos}} \cdot v_{\text{windlos}} = (1 - r) \cdot s_{\text{gesamt}}
    \]</p>

    <p>Konstante Leistung beim Laufen</p>
    <p>\[
    P(v_{\text{wind}}) = P(v_{\text{windlos}})
    \]</p>

    <p>Finale Gleichung des Gleichungssystems</p>
<p>\[
\frac{1}{2} \rho c_d A (v_{\text{gegenwind}} + v')^2 \cdot v' + \alpha m v' = \frac{1}{2} \rho c_d A v_{\text{windlos}}^3 + \alpha m v_{\text{windlos}}\]

<p>mit:</p>

\[
v' = \frac{r \cdot s}{720 - \frac{(1 - r) \cdot s_{\text{gesamt}}}{v_{\text{windlos}}}}

\]</p>

    <p>Endergebnis</p>
    <p>\[
    s_{windlos} = v_{windlos} \cdot 720\,\text{s}
    \]</p>

    <h3>Erklärung der Symbole:</h3>
    <table style="width:100%; font-size: 0.7rem;">
      <tr><td>\( r \)</td><td>Anteil der Strecke mit Wind (1/6 - 1/4)</td></tr>
      <tr><td>\( \rho \)</td><td>Luftdichte (1.2–1.3 kg/m³)</td></tr>
      <tr><td>\( c_d \)</td><td>Strömungswiderstandskoeffizient (0.98–1.05)</td></tr>
      <tr><td>\( A \)</td><td>Stirnfläche (Frau: 0.45-0.52 m²; Mann: 0.54-0.6 m²)</td></tr>
      <tr><td>\(v_{\text{gegenwind}} \)</td><td>Gegenwindgeschwindigkeit (20-24 km/h)</td></tr>
      <tr><td>\( m \)</td><td>Körpermasse (Frau: 55-70 kg; Mann: 65-80 kg)</td></tr>
      <tr><td>\( \alpha \)</td><td>Koeffizient der Mechanischen Leistung (https://www.sciencedirect.com/science/article/abs/pii/S0021929099001876)  (0.95–1.1 m/s²)</td></tr>
      <tr><td>\(v_{\text{wind}} \)</td><td>Laufgeschwindigkeit bei Wind</td></tr>
      <tr><td>\( v_{\text{windlos}} \)</td><td>Windlose Laufgeschwindigkeit</td></tr>
      <tr><td>\(t_{\text{wind}} \)</td><td>Zeit auf der Windlosen Strecke</td></tr>
      <tr><td>\( t_{\text{windlos}}  \)</td><td>Zeit auf der Strecke mit Wind</td></tr>
      <tr><td>\( s_{\text{windlos}}  \)</td><td>Strecke wenn es keinen Wind gäbe</td></tr>
    </table>
  </div>
</div>


  <script>
    const streckeInput = document.getElementById("strecke");
    const resultInput = document.getElementById("result");
    const barMin = document.getElementById("barMin");
    const barMax = document.getElementById("barMax");

    function calculateStrecke(strecke, gender) {
  const wValues = [1.19, 1.25];
  const CValues = [0.98, 1.05];
  const alphaValues = [0.95, 1.1];
  const AValues = gender === "w" ? [0.45, 0.52] : [0.54, 0.6];
  const mValues = gender === "w" ? [55, 70] : [65, 80];
  const rValues = [1 / 6, 1 / 4]; // Windanteil der Strecke

  const s = strecke;
const vValues = [20 / 3.6, 24 / 3.6]; // Intervall für Gegenwindgeschwindigkeit (5.56–6.67 m/s)
  const t = 720;

  let xMin = Infinity;
  let xMax = -Infinity;

  const xStart = 0.5;
  const xEnd = Math.max(10, s / 50);
for (const v of vValues) {
  for (const r of rValues) {
    const s_wind = r * s;
    const s_windlos = (1 - r) * s;

    for (const w of wValues) {
      for (const C of CValues) {
        for (const A of AValues) {
          for (const alpha of alphaValues) {
            for (const m of mValues) {
              const a = 0.5 * w * C * A;
              const f = alpha * m;

              function func(x) {
                if (x <= 0) return NaN;
                const denom = t - s_windlos / x;
                if (denom <= 0) return NaN;

                const v_eff = s_wind / denom;
                const left = a * Math.pow(v + v_eff, 2) * v_eff + f * v_eff;
                const right = a * Math.pow(x, 3) + f * x;
                return left - right;
              }

              for (let x = xStart; x <= xEnd; x += 0.01) {
                const y1 = func(x);
                const y2 = func(x + 0.01);

                if (isNaN(y1) || isNaN(y2)) continue;
                if (y1 * y2 < 0) {
                  const root = x - y1 * (0.01 / (y2 - y1));
                  if (root > 0) {
                    if (root < xMin) xMin = root;
                    if (root > xMax) xMax = root;
                  }
                }
              }
            }
          }
        }
      }
    }
  }}

  if (xMin === Infinity || xMax === -Infinity) {
    return { xMin: NaN, xMax: NaN };
  }

  return {
    xMin: xMin,
    xMax: xMax,
    streckeMin: xMin * 720,
    streckeMax: xMax * 720
  };
}


    function updateResult() {
      const strecke = parseFloat(streckeInput.value);
      const gender = document.querySelector('input[name="gender"]:checked').value;

      if (!isNaN(strecke)) {
        const result = calculateStrecke(strecke, gender);
        if (isNaN(result.xMin)) {
          resultInput.value = "Keine Lösung";
          barMin.style.width = "0";
          barMax.style.width = "0";
        } else {
          resultInput.value = `Min: ${result.streckeMin.toFixed(2)} m, Max: ${result.streckeMax.toFixed(2)} m`;

          const maxWidth = 100;
          const scale = Math.max(result.streckeMax, 1);
          const widthMin = (result.streckeMin / scale) * maxWidth;
          const widthMax = (result.streckeMax / scale) * maxWidth;

          barMin.style.width = `${widthMin}%`;
          barMin.textContent = `Min: ${result.streckeMin.toFixed(0)} m`;

          barMax.style.width = `${widthMax}%`;
          barMax.textContent = `Max: ${result.streckeMax.toFixed(0)} m`;
        }
      } else {
        resultInput.value = "";
        barMin.style.width = "0";
        barMax.style.width = "0";
      }
    }

    streckeInput.addEventListener("input", updateResult);
    document.querySelectorAll('input[name="gender"]').forEach(radio => {
      radio.addEventListener("change", updateResult);
    });

    updateResult(); // initial aufrufen
  </script>
</body>
</html>
